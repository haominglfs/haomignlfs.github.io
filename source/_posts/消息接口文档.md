---
title: 消息接口文档
date: 2019-05-21 22:15:05
tags: 工作
---

#### 简介

消息接口采用RPC方式,框架使用hessian

<!--more-->

#### 导入jar包和配置文件

> 类路径下添加配置文件 msg.properties

```properties
msgServiceUrl=http://msg服务地址/msgService
```

> 引入jar包  css-msg-client.jar

#### 使用方法

```java
public class MsgClientTest {

    private Msg msg;
    private String uuid;

    @Before
    public void before() throws Exception {

    }

    @After
    public void after() throws Exception {
        msg = null;
    }

    /**
     * 更新消息信息
     */
    @Test
    public void testUpdMsg() throws Exception {
        Msg msg2 = new Msg.Builder(
                "ff64c0cf78fb4d1295e7ca74c6226fe0",
                "测试消息同步待办07",
                MsgType.DAIBAN,
                "64180c3b556f4510abf541fecfc5eb5e")
                .bizLoop("处核")
                .bizUrl("http://oa.cec.com.cn/dirMsg.action")
                .bizType("我要用印1111")
                .build();

        MsgResult msgResult = MsgClient.updMsg(msg2);
        System.out.println(msgResult);
    }

    /**
     * 添加消息
     */
    @Test
    public void testAddMsg() throws Exception {
        Random random = new Random();
        uuid = UuidUtil.getUuid();
        msg = new Msg.Builder(
                uuid,
                "测试消息" + random.nextInt(100),
                MsgType.DAIBAN,
                "64180c3b556f4510abf541fecfc5eb5e")
                .bizLoop("处核")
                .bizUrl("http://oa.cec.com.cn/dirMsg.action")
                .bizType("我要用印")
                .build();
        MsgResult msgResult = MsgClient.addMsg(msg);
        System.out.println(msgResult);
    }

    /**
    * 更新消息状态
    */
    @Test
    public void testUpdMsgStatus() throws Exception {
        MsgResult msgResult = MsgClient.updMsgStatus("ff64c0cf78fb4d1295e7ca74c6226fe0", "64180c3b556f4510abf541fecfc5eb5e", MsgStatus.DEALED);
        System.out.println(msgResult);
    }
}
```

#### 参数

1. 消息实体类

```java
private String uuid;
private String sysId;    //系统id
private String bizId;    //消息id
private String bizType;  //消息类型
private String bizLoop;     //当前环节
private String bizName;  //消息名称
private String bizUrl;   //链接路径
private String receiver; //接收人
private Integer msgStatus;   //状态
private Date createTime;
private Date updateTime;
private Integer msgType;     //消息分类
```

2. 消息类型

   ```java
   public static final Integer DAIBAN = 1; //待办
   public static final Integer DAIYUE = 2; //待阅
   public static final Integer YOUJIAN = 3; //邮件
   public static final Integer GWDAIBAN = 4; //岗位待办
   ```

   

3. 消息状态

   ```
   public static final Integer NEW = 1;  //新建
   public static final Integer DEALED = 2; //已处理
   public static final Integer DELETED = 3; //删除
   ```

   

#### 返回值

```java
private int code; //状态码  0成功  1失败
private String description; //描述
private Msg info;  //消息信息
```

